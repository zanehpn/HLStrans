compute_neighbor_tables